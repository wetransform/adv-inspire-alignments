<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<alignment xmlns="http://www.esdi-humboldt.eu/hale/alignment">
    <base prefix="ba1" location="../base-tn.halex.alignment.xml"/>
    <base prefix="ba2" location="../base-functions.halex.alignment.xml"/>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="C48d3be90-5843-4323-bd79-ba1928b2429e" priority="normal">
        <source>
            <property>
                <type name="AA_ObjektType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="lebenszeitintervall" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="AA_Lebenszeitintervall" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="beginnt" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
            </property>
        </source>
        <target>
            <property>
                <type name="NetworkElementType" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="C92d71e60-b3b7-4864-a6a2-fc6d46d9ac4c" priority="normal">
        <source>
            <property>
                <type name="AA_ObjektType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="lebenszeitintervall" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="AA_Lebenszeitintervall" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="endet" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
            </property>
        </source>
        <target>
            <property>
                <type name="NetworkElementType" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="endLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.create" id="Cbc1d0004-f009-40ce-a9e0-284e0852cbd0" priority="low">
        <target>
            <class>
                <type name="NominalTrackGaugeType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

// Erstelle ein NominalTrackGauge-Objekt für jeden vorkommenden Wert
collect.nominalTrackGauge.consume { key, values -&gt;
	def _id = 'NominalTrackGauge_' + key
	def _ns = _project.vars.INSPIRE_NAMESPACE
	
	_target {
		if (key == 'standard') {
			// Spurweite ist nur für standard bekannt
			nominalGauge( '1435' ) {
				uom( 'mm' )
			}
		}
		else {
			nominalGauge {
				nilReason( 'unknown' )
				uom( 'mm' )
			}
		}
		nominalGaugeCategory( key )
		id( _id )
		inspireId {
			Identifier {
				namespace( _ns )
				localId( _id )
			}
		}
		identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id : _id ) {
			codeSpace( 'http://inspire.ec.europa.eu/ids' )
		}
		
		// Referenz zu gesammelten Objekten mit dieser Eigenschaft
		values.each { linkId -&gt;
			networkRef {
				NetworkReference {
					element {
						href( "#$linkId" )
					}
				}
			}
		}
	}
}
</core:text>
        </complexParameter>
        <documentation>Erstellt ein `NominalTrackGauge`-Objekt für jeden in den Daten vorkommenden Wert für `nominalGaugeCategory`.

Die INSPIRE localId und die GML id werden dabei basierend auf dem Namen der Objektart und dem repräsentierten Wert gebildet, z.B. `NominalTrackGauge_standard`.

Es werden Referenzen (NetworkReference) zu allen Netzwerk-Elementen (z.B. `RailwayLink`) erstellt, welche die entsprechende Eigenschaft aufweisen. Diese Information wurde zuvor beim Erstellen dieser Features in einem Index abgelegt.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.create" id="C6f5276f4-be5d-4509-a927-a39aea98844a" priority="low">
        <target>
            <class>
                <type name="NumberOfTracksType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

// Erstelle ein NumberOfTracks-Objekt für jeden vorkommenden Wert
//
// Inhalt der hier gesetzt wird sind die Identifier und die Verknüpfungen
// zu den entsprechenden Netzwerk-Elementen
collect.numberOfTracks.consume { key, values -&gt;
	def _id = 'NumberOfTracks_' + key
	def _ns = _project.vars.INSPIRE_NAMESPACE
	
	_target {
		numberOfTracks( key )
		id( _id )
		inspireId {
			Identifier {
				namespace( _ns )
				localId( _id )
			}
		}
		identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id : _id ) {
			codeSpace( 'http://inspire.ec.europa.eu/ids' )
		}
		
		// Referenz zu gesammelten Netzwerk-Elementen mit dieser Eigenschaft
		values.each { linkId -&gt;
			networkRef {
				NetworkReference {
					element {
						href( "#$linkId" )
					}
				}
			}
		}
	}
}
</core:text>
        </complexParameter>
        <documentation>Erstellt ein `NumberOfTracks`-Objekt für jeden in den Daten vorkommenden Wert für `numberOfTracks`.

Die INSPIRE localId und die GML id werden dabei basierend auf dem Namen der Objektart und dem repräsentierten Wert gebildet.

Es werden Referenzen (NetworkReference) zu allen Netzwerk-Elementen (z.B.  `RailwayLink`) erstellt, welche die entsprechende Eigenschaft aufweisen. Diese Information wurde zuvor beim Erstellen dieser Features in einem Index abgelegt.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="Ca5062864-f188-41e7-a800-dc412d36911d" priority="normal">
        <target>
            <property>
                <type name="NumberOfTracksType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="minMaxNumberOfTracks" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="Cbdf5128c-1dad-4827-806e-ee6a6fc3cc50" priority="normal">
        <source>
            <class>
                <type name="AX_BahnverkehrType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
            </class>
        </source>
        <target>
            <class>
                <type name="RailwayAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

def _id = 'RailwayArea_' + _source.p.id.value() 

_target {
}

// bestimme RailwayType(s)
def railwayTypes = []
_source.p.bahnkategorie.each { bkt -&gt;
	switch (bkt) {
	case '1100': // Eisenbahn
	case '1101': // Personenverkehr
	case '1102': // Güterverkehr
	case '1103': // Betriebsverkehr
	case '1104': // S-Bahn
	case '1400': // Museumsbahn
	case '1500': // Bahn im Freizeitpark
		railwayTypes &lt;&lt; 'train'
		break
	case '1200': // Stadtbahn
	case '1202': // U-Bahn
		railwayTypes &lt;&lt; 'metro'
		break
	case '1201': // Straßenbahn
		railwayTypes &lt;&lt; 'tramway'
		break
	case '1300': // Seilbahn, Bergbahn
	case '1302': // Standseilbahn
		railwayTypes &lt;&lt; 'funicular'
		break
	case '1301': // Zahnradbahn
		railwayTypes &lt;&lt; 'cogRailway'
		break
	case '1600': // Magnetschwebebahn
		railwayTypes &lt;&lt; 'magneticLevitation'
		break
	}
}

// bestimme ConditionOfFacility
def conditionOfFacility = 'functional'
switch (_source.p.zustand.value()) {
case '2100': // Außer Betrieb, stillgelegt, verlassen
	conditionOfFacility = 'disused'
	break
case '4000': // Im Bau
	conditionOfFacility = 'underConstruction'
	break
case '8000': // Im Bau
	conditionOfFacility = 'projected'
	break
}

/*
 * Sammeln von Informationen bzgl. hatDirektUnten für VerticalPosition
 */
def untenRefs = _source.p.hatDirektUnten.href.values()
def verticalPositions = untenRefs.findResults { identifier -&gt;
	def bwf = collect.bauwerksfunktion[identifier].value()
	if (bwf) {
		switch (bwf) {
		// AX_BauwerkImVerkehrsbereich
		case '1800': // Brücke
		case '1801': // Mehrstöckige Brücke
		case '1802': // Bogenbrücke
		case '1803': // Fachwerkbrücke
		case '1804': // Hängebrücke
		case '1805': // Pontonbrücke
		case '1806': // Drehbrücke
		case '1807': // Hebebrücke
		case '1808': // Zugbrücke
		case '1820': // Steg
		case '1830': // Hochbahn, Hochstraße
		case '1890': // Schleusenkammer
		// AX_BauwerkImGewaesserbereich
		case '2030': // Staumauer
		case '2040': // Staudamm
		case '2050': // Wehr
		case '2060': // Sicherheitstor
		case '2080': // Sperrwerk
			return 'suspendedOrElevated'
		// AX_BauwerkImVerkehrsbereich
		case '1870': // Tunnel, Unterführung
		// AX_BauwerkImGewaesserbereich
		case '2010': // Durchlass
		case '2011': // Rohrdurchlass
		case '2012': // Düker
		case '2070': // Siel
		case '2090': // Schöpfwerk
			return 'underground'
		}
	}
	else {
		null
	}
} as Set
def verticalPosition
if (!verticalPositions) {
	verticalPosition = 'onGroundSurface'
}
else {
	verticalPosition = verticalPositions.iterator().next()
	if (verticalPositions.size() &gt; 1) {
		_log.error('Multiple different values for vertical position of an object: ' + verticalPositions)
	}
}

// Sammle ID für Netzwerk
collect.network &lt;&lt; _id
// Sammle ID für RailwayType(s)
railwayTypes.each { railwayType -&gt;
	collect.railwayType[railwayType] &lt;&lt; _id
}
// Sammle ID für ConditionOfFacility
collect.conditionOfFacility[conditionOfFacility] &lt;&lt; _id
// Sammle ID für VerticalPosition
collect.verticalPosition[verticalPosition] &lt;&lt; _id
</core:text>
        </complexParameter>
        <documentation>Erstellt eine `RailwayArea` aus einem `AX_Bahnverkehr`.

Die erstellte `RailwayArea` wird dem Index von Netzwerk-Elementen hinzugefügt.

Zusätzlich werden folgende Informationen in den entsprechenden Indizes abgelegt:

**RailwayType**

Der `railwayType` wird wie folgt aus dem Attribute `bahnkategorie` ermittelt:

bahnkategorie | railwayType
- | -
`1100` *(Eisenbahn)* | `train`
`1102` *(Güterverkehr)* | `train`
`1104` *(S-Bahn)* | `train`
`1400` *(Museumsbahn)* | `train`
`1500` *(Bahn im Freizeitpark)* | `train`
`1200` *(Stadtbahn)* | `metro`
`1202` *(U-Bahn)* | `metro`
`1201` *(Straßenbahn)* | `tramway`
`1300` *(Seilbahn, Bergbahn)* | `funicular`
`1302` *(Standseilbahn)* | `funicular`
`1301` *(Zahnradbahn)* | `cogRailway`
`1600` *(Magnetschwebebahn)* | `magneticLevitation`

**ConditionOfFacility**

Die *conditionOfFacility* wird wie folgt aus dem Attribut `zustand` ermittelt:

zustand | conditionOfFacility
- | -
`2100` *(Außer Betrieb, stillgelegt, verlassen)* | `disused`
`4000` *(Im Bau)* | `underConstruction`

In allen anderen Fällen wird *conditionOfFacility* als `functional` angenommen.

**VerticalPosition**

Die *verticalPosition* wird über das Attribut `hatDirektUnten` ermittelt.
Referenzen auf `AX_BauwerkImVerkehrsbereich` und `AX_BauwerkImGewaesserbereich` werden über einen Index nachgeschlagen um die entsprechende `bauwerksfunktion` zu erhalten.
Aus der `bauwerksfunktion` wird der Wert wie folgt ermittelt:

bauwerksfunktion | verticalPosition
- | -
`1800` *(Brücke)* | `suspendedOrElevated`
`1801` *(Mehrstöckige Brücke)* | `suspendedOrElevated`
`1802` *(Bogenbrücke)* | `suspendedOrElevated`
`1803` *(Fachwerkbrücke)* | `suspendedOrElevated`
`1804` *(Hängebrücke)* | `suspendedOrElevated`
`1805` *(Pontonbrücke)* | `suspendedOrElevated`
`1806` *(Drehbrücke)* | `suspendedOrElevated`
`1807` *(Hebebrücke)* | `suspendedOrElevated`
`1808` *(Zugbrücke)* | `suspendedOrElevated`
`1820` *(Steg)* | `suspendedOrElevated`
`1830` *(Hochbahn, Hochstraße)* | `suspendedOrElevated`
`1890` *(Schleusenkammer)* | `suspendedOrElevated`
`2030` *(Staumauer)* | `suspendedOrElevated`
`2040` *(Staudamm)* | `suspendedOrElevated`
`2050` *(Wehr)* | `suspendedOrElevated`
`2060` *(Sicherheitstor)* | `suspendedOrElevated`
`2080` *(Sperrwerk)* | `suspendedOrElevated`
`1870` *(Tunnel, Unterführung)* | `underground`
`2010` *(Durchlass)* | `underground`
`2011` *(Rohrdurchlass)* | `underground`
`2012` *(Düker)* | `underground`
`2070` *(Siel)* | `underground`
`2090` *(Schöpfwerk)* | `underground`

Für alle anderen `bauwerksfunktion`en, Referenzen auf andere Objekte oder auch bei Nicht-Vorhandensein von Referenzen wird der Wert `onGroundSurface` angenommen. Bei mehreren verschiedenen Referenzen haben `suspendedOrElevated` und `underground` Vorrang vor `onGroundSurface`.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C4d69e8d8-0f66-4fb1-9343-465ee5604ff3" priority="normal">
        <target>
            <property>
                <type name="RailwayAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="custom:alignment:adv.geometry.simplefeature" id="C2415887f-d793-4ea9-be9a-5401165c7541" priority="normal">
        <source name="geometrie">
            <property>
                <type name="AX_BahnverkehrType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="position" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RailwayAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="geometry" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="Cab81ca0e-f1a1-4311-aeb5-379d03826e51" priority="normal">
        <source name="id">
            <property>
                <type name="AX_BahnverkehrType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RailwayAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
    </cell>
    <cell relation="custom:alignment:adv.inspire.identifier" id="Ce5d5030b-02c9-4cce-8c2e-0da8d0a0303b" priority="normal">
        <source name="id">
            <property>
                <type name="AX_BahnverkehrType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RailwayAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C825ec2fa-a425-41b9-a8af-d4d014d0de57" priority="normal">
        <source name="id">
            <property>
                <type name="AX_BahnverkehrType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RailwayAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="localId" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
    </cell>
    <cell relation="custom:alignment:adv.inspire.namespace" id="C565ee942-8f6f-4e42-b213-23337a892129" priority="normal">
        <target>
            <property>
                <type name="RailwayAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="namespace" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C1d0cdc85-bd58-42ce-9698-9f42683e2d58" priority="normal">
        <target>
            <property>
                <type name="RailwayAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="Cdc70ecf5-b963-44da-80b4-854b89fa7440" priority="normal">
        <target>
            <property>
                <type name="RailwayAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="validTo" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.create" id="C26cdc371-11f7-4d7d-990e-555c63de147b" priority="low">
        <target>
            <class>
                <type name="RailwayElectrificationType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

// Erstelle ein RailwayElectrification-Objekt für jeden vorkommenden Wert
//
// Inhalt der hier gesetzt wird sind die Identifier und die Verknüpfungen
// zu den entsprechenden Netzwerk-Elementen
collect.electrified.consume { key, values -&gt;
	def _id = 'RailwayElectrification_' + key
	def _ns = _project.vars.INSPIRE_NAMESPACE
	
	_target {
		electrified( key )
		id( _id )
		inspireId {
			Identifier {
				namespace( _ns )
				localId( _id )
			}
		}
		identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id : _id ) {
			codeSpace( 'http://inspire.ec.europa.eu/ids' )
		}
		
		// Referenz zu gesammelten Netzwerk-Elementen mit dieser Eigenschaft
		values.each { linkId -&gt;
			networkRef {
				NetworkReference {
					element {
						href( "#$linkId" )
					}
				}
			}
		}
	}
}
</core:text>
        </complexParameter>
        <documentation>Erstellt ein `RailwayElectrification`-Objekt für jeden in den Daten vorkommenden Wert für `electrified`.

Die INSPIRE localId und die GML id werden dabei basierend auf dem Namen der Objektart und dem repräsentierten Wert gebildet.

Es werden Referenzen (NetworkReference) zu allen Netzwerk-Elementen (z.B.  `RailwayLink`) erstellt, welche die entsprechende Eigenschaft aufweisen. Diese Information wurde zuvor beim Erstellen dieser Features in einem Index abgelegt.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.merge" id="Ca500e629-76b0-4cda-b53f-c9db0c272403" priority="normal">
        <source>
            <class>
                <type name="AX_BahnstreckeType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1">
                    <condition lang="CQL">nummerDerBahnstrecke is not null</condition>
                </type>
            </class>
        </source>
        <target>
            <class>
                <type name="RailwayLineType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
            </class>
        </target>
        <parameter value="{http://www.adv-online.de/namespaces/adv/gid/7.1}name" name="additional_property"/>
        <parameter value="false" name="auto_detect"/>
        <parameter value="{http://www.adv-online.de/namespaces/adv/gid/7.1}nummerDerBahnstrecke" name="property"/>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
_target {
}

// ID zum hinterlegen in Indizes bestimmen

// alle Quell-IDs als Liste
def identifiers = _source.p.id.values()

def _id

if (identifiers.size() == 1) {
  // verwende Original-ID falls nur eine Quelle
  _id = 'RailwayLine_' + identifiers[0]
}
else {
  // sortieren (TODO spezielle Ordnung benötigt?)
  identifiers = identifiers.sort()

  def identString = identifiers.join()

  _id = 'RailwayLine_' + _.crypto.sha256(identString)
}


withTransformationContext {
	def collect = _.context.collector(it)
	// Sammle ID für Netzwerk
	collect.network &lt;&lt; _id
}
</core:text>
        </complexParameter>
        <documentation>Erstellt `RailwayLine`s aus `AX_Bahnstrecke`n mit gleicher `nummerDerBahnstrecke`.

Die erstellte `RailwayLine` wird dem Index von Netzwerk-Elementen hinzugefügt.</documentation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.date.earliest" id="Ccef52db8-7149-4567-bfc0-a777865aa5b4" priority="normal">
        <source name="dates">
            <property>
                <type name="AX_BahnstreckeType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="lebenszeitintervall" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="AA_Lebenszeitintervall" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="beginnt" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RailwayLineType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="beginLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
    </cell>
    <cell relation="custom:alignment:adv.inspire.date.earliest" id="C5a51591e-2db2-4e05-a6c4-d01b59122d91" priority="normal">
        <source name="dates">
            <property>
                <type name="AX_BahnstreckeType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="lebenszeitintervall" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="AA_Lebenszeitintervall" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="endet" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RailwayLineType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="endLifespanVersion" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
    </cell>
    <cell relation="custom:alignment:adv.inspire.GeographicalName.simple" id="C82626e7b-d27c-44b0-8821-6a49db42400a" priority="normal">
        <source name="spelling">
            <property>
                <type name="AX_BahnstreckeType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="name" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RailwayLineType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C80652f08-0840-40b1-b701-c4eb5b4e2856" priority="normal">
        <target>
            <property>
                <type name="RailwayLineType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="unknown" name="value"/>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C39cd808f-36de-4888-ae0f-d56a457636fa" priority="normal">
        <source name="id">
            <property>
                <type name="AX_BahnstreckeType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RailwayLineType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
    </cell>
    <cell relation="custom:alignment:adv.inspire.identifier" id="C3cd86c2c-be9e-45f3-a85d-2f9fa24f0f54" priority="normal">
        <source name="id">
            <property>
                <type name="AX_BahnstreckeType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RailwayLineType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="Cd19e2f21-33e0-426b-af74-dc2cd251c1da" priority="normal">
        <source name="id">
            <property>
                <type name="AX_BahnstreckeType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RailwayLineType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="localId" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
    </cell>
    <cell relation="custom:alignment:adv.inspire.namespace" id="C219ed724-f214-45a8-b291-5272fd866b99" priority="normal">
        <target>
            <property>
                <type name="RailwayLineType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="namespace" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.formattedstring" id="Cf0ca6058-fbaf-4604-a265-5c7f3d2ade2a" priority="normal">
        <source name="var">
            <property>
                <type name="AX_BahnstreckeType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RailwayLineType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="link" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="href" ns="http://www.w3.org/1999/xlink"/>
            </property>
        </target>
        <parameter value="#RailwayLink_{id}" name="pattern"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C0047cb98-5745-4d80-9ea9-5785af1a3809" priority="normal">
        <target>
            <property>
                <type name="RailwayLineType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="post" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.rename" id="Cc8f197c0-2249-4a5e-956f-85addea8eb55" priority="normal">
        <source>
            <property>
                <type name="AX_BahnstreckeType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="nummerDerBahnstrecke" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RailwayLineType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="railwayLineCode" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
            </property>
        </target>
        <parameter value="false" name="ignoreNamespaces"/>
        <parameter value="false" name="structuralRename"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="Cd99f8fb6-fc49-4a92-85bd-059d1e7deb42" priority="normal">
        <target>
            <property>
                <type name="RailwayLineType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C688e237c-ab7e-4be7-8d06-0e366460c193" priority="normal">
        <target>
            <property>
                <type name="RailwayLineType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="validTo" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="C19325fbe-66ff-4f83-9c63-947af27dc065" priority="normal">
        <source>
            <class>
                <type name="AX_BahnstreckeType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
            </class>
        </source>
        <target>
            <class>
                <type name="RailwayLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

_target {
}

// bestimme NominalTrackGauge
def nominalTrackGauge
switch (_source.p.spurweite.value()) {
case '1000': // Normalspur (Regelspur, Vollspur)
	nominalTrackGauge = 'standard'
	break
case '2000': // Schmalspur
	nominalTrackGauge = 'narrow'
	break
case '3000': // Breitspur
	nominalTrackGauge = 'broad'
	break
}

// bestimme RailwayType(s)
def railwayTypes = []
_source.p.bahnkategorie.each { bkt -&gt;
	switch (bkt) {
	case '1100': // Eisenbahn
	case '1101': // Personenverkehr
	case '1102': // Güterverkehr
	case '1104': // S-Bahn
	case '1400': // Museumsbahn
	case '1500': // Bahn im Freizeitpark
		railwayTypes &lt;&lt; 'train'
		break
	case '1200': // Stadtbahn
	case '1202': // U-Bahn
		railwayTypes &lt;&lt; 'metro'
		break
	case '1201': // Straßenbahn
		railwayTypes &lt;&lt; 'tramway'
		break
	case '1300': // Seilbahn, Bergbahn
	case '1302': // Standseilbahn
		railwayTypes &lt;&lt; 'funicular'
		break
	case '1301': // Zahnradbahn
		railwayTypes &lt;&lt; 'cogRailway'
		break
	case '1600': // Magnetschwebebahn
		railwayTypes &lt;&lt; 'magneticLevitation'
		break
	}
}

// bestimme RailwayUse(s)
def railwayUses = []
_source.p.bahnkategorie.each { bkt -&gt;
	switch (bkt) {
	case '1100': // Eisenbahn
	case '1300': // Seilbahn, Bergbahn
	case '1302': // Standseilbahn
	case '1301': // Zahnradbahn
		railwayUses &lt;&lt; 'mixed'
		break
	case '1102': // Güterverkehr
		railwayUses &lt;&lt; 'cargo'
		break
	case '1101': // Personenverkehr	
	case '1104': // S-Bahn
	case '1200': // Stadtbahn
	case '1201': // Straßenbahn
	case '1202': // U-Bahn
	case '1400': // Museumsbahn
	case '1500': // Bahn im Freizeitpark
	case '1600': // Magnetschwebebahn
		railwayUses &lt;&lt; 'passengers'
		break
	}
}

// bestimme NumberOfTracks
def numberOfTracks
switch (_source.p.anzahlDerStreckengleise.value()) {
case '1000': // Eingleisig
	numberOfTracks = 1
	break
case '2000': // Zweigleisig
	numberOfTracks = 2
	break
}

// bestimme RailwayElectrification
def electrified = _source.p.elektrifizierung.value() != '2000'

// bestimme ConditionOfFacility
def conditionOfFacility = 'functional'
switch (_source.p.zustand.value()) {
case '2100': // Außer Betrieb, stillgelegt, verlassen
	conditionOfFacility = 'disused'
	break
case '4000': // Im Bau
	conditionOfFacility = 'underConstruction'
	break
}

/*
 * Sammeln von Informationen bzgl. hatDirektUnten für VerticalPosition
 */
def untenRefs = _source.p.hatDirektUnten.href.values()
def verticalPositions = untenRefs.findResults { identifier -&gt;
	def bwf = collect.bauwerksfunktion[identifier].value()
	if (bwf) {
		switch (bwf) {
		// AX_BauwerkImVerkehrsbereich
		case '1800': // Brücke
		case '1801': // Mehrstöckige Brücke
		case '1802': // Bogenbrücke
		case '1803': // Fachwerkbrücke
		case '1804': // Hängebrücke
		case '1805': // Pontonbrücke
		case '1806': // Drehbrücke
		case '1807': // Hebebrücke
		case '1808': // Zugbrücke
		case '1820': // Steg
		case '1830': // Hochbahn, Hochstraße
		case '1890': // Schleusenkammer
		// AX_BauwerkImGewaesserbereich
		case '2030': // Staumauer
		case '2040': // Staudamm
		case '2050': // Wehr
		case '2060': // Sicherheitstor
		case '2080': // Sperrwerk
			return 'suspendedOrElevated'
		// AX_BauwerkImVerkehrsbereich
		case '1870': // Tunnel, Unterführung
		// AX_BauwerkImGewaesserbereich
		case '2010': // Durchlass
		case '2011': // Rohrdurchlass
		case '2012': // Düker
		case '2070': // Siel
		case '2090': // Schöpfwerk
			return 'underground'
		}
	}
	else {
		null
	}
} as Set
def verticalPosition
if (!verticalPositions) {
	verticalPosition = 'onGroundSurface'
}
else {
	verticalPosition = verticalPositions.iterator().next()
	if (verticalPositions.size() &gt; 1) {
		_log.error('Multiple different values for vertical position of an object: ' + verticalPositions)
	}
}

// ID zum hinterlegen in Indizes
def sourceId = _source.p.id.value()
def _id = "RailwayLink_${sourceId}"

// Sammle ID für Netzwerk
collect.network &lt;&lt; _id
// Sammle ID für NominalTrackGauge
if (nominalTrackGauge) {
	collect.nominalTrackGauge[nominalTrackGauge] &lt;&lt; _id
}
// Sammle ID für RailwayType(s)
railwayTypes.each { railwayType -&gt;
	collect.railwayType[railwayType] &lt;&lt; _id
}
// Sammle ID für RailwayUse(s)
railwayUses.each { railwayUse -&gt;
	collect.railwayUse[railwayUse] &lt;&lt; _id
}
// Sammle ID für NumberOfTracks
if (numberOfTracks) {
	collect.numberOfTracks[numberOfTracks] &lt;&lt; _id
}
// Sammle ID für RailwayElectrification
collect.electrified[electrified] &lt;&lt; _id
// Sammle ID für ConditionOfFacility
collect.conditionOfFacility[conditionOfFacility] &lt;&lt; _id
// Sammle ID für VerticalPosition
collect.verticalPosition[verticalPosition] &lt;&lt; _id
</core:text>
        </complexParameter>
        <documentation>Erstellt einen `RailwayLink` aus einer `AX_Bahnstrecke`.

Der erstellte `RailwayLink` wird dem Index von Netzwerk-Elementen hinzugefügt.

Zusätzlich werden folgende Informationen in den entsprechenden Indizes abgelegt:

**NominalTrackGauge**

Die `nominalGaugeCategory` wird wie folgt aus dem Attribut `spurweite` ermittelt:

spurweite  | nominalGaugeCategory
- | -
`1000` *(Normalspur (Regelspur, Vollspur))* | `standard`
`2000` *(Schmalspur)* | `narrow`
`3000` *(Breitspur)* | `broad`

**RailwayType**

Der `railwayType` wird wie folgt aus dem Attribute `bahnkategorie` ermittelt:

bahnkategorie | railwayType
- | -
`1100` *(Eisenbahn)* | `train`
`1102` *(Güterverkehr)* | `train`
`1104` *(S-Bahn)* | `train`
`1400` *(Museumsbahn)* | `train`
`1500` *(Bahn im Freizeitpark)* | `train`
`1200` *(Stadtbahn)* | `metro`
`1202` *(U-Bahn)* | `metro`
`1201` *(Straßenbahn)* | `tramway`
`1300` *(Seilbahn, Bergbahn)* | `funicular`
`1302` *(Standseilbahn)* | `funicular`
`1301` *(Zahnradbahn)* | `cogRailway`
`1600` *(Magnetschwebebahn)* | `magneticLevitation`

**RailwayUse**

Die `railwayUse` wird wie folgt aus dem Attribute `bahnkategorie` bestimmt:

bahnkategorie | railwayUse
- | -
`1100` *(Eisenbahn)* | `mixed`
`1300` *(Seilbahn, Bergbahn)* | `mixed`
`1302` *(Standseilbahn)* | `mixed`
`1301` *(Zahnradbahn)* | `mixed`
`1102` *(Güterverkehr)* | `cargo`
`1104` *(S-Bahn)* | `passengers`
`1200` *(Stadtbahn)* | `passengers`
`1201` *(Straßenbahn)* | `passengers`
`1202` *(U-Bahn)* | `passengers`
`1400` *(Museumsbahn)* | `passengers`
`1500` *(Bahn im Freizeitpark)* | `passengers`
`1600` *(Magnetschwebebahn)* | `passengers`

**NumberOfTracks**

Die `numberOfTracks` wird wie folgt aus dem Attribut `anzahlDerStreckengleise` bestimmt:

anzahlDerStreckengleise | numberOfTracks
- | -
`1000` *(Eingleisig)* | `1`
`2000` *(Zweigleisig)* | `2`

**RailwayElectrification**

Ob ein `RailwayLink` elektrifiziert (`electrified`) ist wird aus dem Attribut `elektrifizierung` bestimmt. Er ist nicht elektrifiziert falls das Attribute den Wert `2000` (Nicht elektrifiziert) hat.

**ConditionOfFacility**

Die *conditionOfFacility* wird wie folgt aus dem Attribut `zustand` ermittelt:

zustand | conditionOfFacility
- | -
`2100` *(Außer Betrieb, stillgelegt, verlassen)* | `disused`
`4000` *(Im Bau)* | `underConstruction`

In allen anderen Fällen wird *conditionOfFacility* als `functional` angenommen.

**VerticalPosition**

Die *verticalPosition* wird über das Attribut `hatDirektUnten` ermittelt.
Referenzen auf `AX_BauwerkImVerkehrsbereich` und `AX_BauwerkImGewaesserbereich` werden über einen Index nachgeschlagen um die entsprechende `bauwerksfunktion` zu erhalten.
Aus der `bauwerksfunktion` wird der Wert wie folgt ermittelt:

bauwerksfunktion | verticalPosition
- | -
`1800` *(Brücke)* | `suspendedOrElevated`
`1801` *(Mehrstöckige Brücke)* | `suspendedOrElevated`
`1802` *(Bogenbrücke)* | `suspendedOrElevated`
`1803` *(Fachwerkbrücke)* | `suspendedOrElevated`
`1804` *(Hängebrücke)* | `suspendedOrElevated`
`1805` *(Pontonbrücke)* | `suspendedOrElevated`
`1806` *(Drehbrücke)* | `suspendedOrElevated`
`1807` *(Hebebrücke)* | `suspendedOrElevated`
`1808` *(Zugbrücke)* | `suspendedOrElevated`
`1820` *(Steg)* | `suspendedOrElevated`
`1830` *(Hochbahn, Hochstraße)* | `suspendedOrElevated`
`1890` *(Schleusenkammer)* | `suspendedOrElevated`
`2030` *(Staumauer)* | `suspendedOrElevated`
`2040` *(Staudamm)* | `suspendedOrElevated`
`2050` *(Wehr)* | `suspendedOrElevated`
`2060` *(Sicherheitstor)* | `suspendedOrElevated`
`2080` *(Sperrwerk)* | `suspendedOrElevated`
`1870` *(Tunnel, Unterführung)* | `underground`
`2010` *(Durchlass)* | `underground`
`2011` *(Rohrdurchlass)* | `underground`
`2012` *(Düker)* | `underground`
`2070` *(Siel)* | `underground`
`2090` *(Schöpfwerk)* | `underground`

Für alle anderen `bauwerksfunktion`en, Referenzen auf andere Objekte oder auch bei Nicht-Vorhandensein von Referenzen wird der Wert `onGroundSurface` angenommen. Bei mehreren verschiedenen Referenzen haben `suspendedOrElevated` und `underground` Vorrang vor `onGroundSurface`.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="C433d8afa-844b-4e56-b6c8-82e369fd15ea" priority="normal">
        <source>
            <class>
                <type name="AX_SeilbahnSchwebebahnType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1">
                    <condition lang="CQL">bahnkategorie = '2500'</condition>
                </type>
            </class>
        </source>
        <target>
            <class>
                <type name="RailwayLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

// nur Objekt mit linienartigen Geometrien behandeln
def geometries = _.geom.findLines(_source.p.position.first())

// Ziel unterstützt keine MultiLineStrings
def curves = _.geom.toSimpleGeometries(geometries: geometries, collections: false)

// Builder konfigurieren
// - Zuweisung der Geometrie auf Ebene von geometry zulassen
_b.strictValueFlags = false

def sourceId = _source.p.id.value()

// bestimme RailwayType
def railwayType = 'suspendedRail'

/*
 * Sammeln von Informationen bzgl. hatDirektUnten für VerticalPosition
 */
def untenRefs = _source.p.hatDirektUnten.href.values()
def verticalPositions = untenRefs.findResults { identifier -&gt;
	def bwf = collect.bauwerksfunktion[identifier].value()
	if (bwf) {
		switch (bwf) {
		// AX_BauwerkImVerkehrsbereich
		case '1800': // Brücke
		case '1801': // Mehrstöckige Brücke
		case '1802': // Bogenbrücke
		case '1803': // Fachwerkbrücke
		case '1804': // Hängebrücke
		case '1805': // Pontonbrücke
		case '1806': // Drehbrücke
		case '1807': // Hebebrücke
		case '1808': // Zugbrücke
		case '1820': // Steg
		case '1830': // Hochbahn, Hochstraße
		case '1890': // Schleusenkammer
		// AX_BauwerkImGewaesserbereich
		case '2030': // Staumauer
		case '2040': // Staudamm
		case '2050': // Wehr
		case '2060': // Sicherheitstor
		case '2080': // Sperrwerk
			return 'suspendedOrElevated'
		// AX_BauwerkImVerkehrsbereich
		case '1870': // Tunnel, Unterführung
		// AX_BauwerkImGewaesserbereich
		case '2010': // Durchlass
		case '2011': // Rohrdurchlass
		case '2012': // Düker
		case '2070': // Siel
		case '2090': // Schöpfwerk
			return 'underground'
		}
	}
	else {
		null
	}
} as Set
def verticalPosition
if (!verticalPositions) {
	verticalPosition = 'onGroundSurface'
}
else {
	verticalPosition = verticalPositions.iterator().next()
	if (verticalPositions.size() &gt;= 1) {
		_log.error('Multiple different values for vertical position of an object: ' + verticalPositions)
	}
}

// Ziel-Objekt für jede Linie erstellen
int num = 1
curves.each { curve -&gt;
	// ID bestimmen
	def _id = "RailwayLink_${sourceId}_${num}"
	def _ns = _project.vars.INSPIRE_NAMESPACE

	// Ziel-Objekt erstellen
	_target {
		id( _id )
		inspireId {
			Identifier {
				localId( _id )
				namespace( _ns )
			}
		}
		identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id : _id ) {
			codeSpace( 'http://inspire.ec.europa.eu/ids' )
		}
		centrelineGeometry(curve)
	}
	
	// Sammle ID für Netzwerk	
	collect.network &lt;&lt; _id
	// Sammle ID für RailwayType
	collect.railwayType[railwayType] &lt;&lt; _id
	// Sammle ID für VerticalPosition
	collect.verticalPosition[verticalPosition] &lt;&lt; _id
	
	num++
}
</core:text>
        </complexParameter>
        <documentation>Erstellt `RailwayLink` aus einer `AX_SeilbahnSchwebebahn` (nur `bahnkategorie` *Schwebebahn*).

Die Geometrie des Quell-Objekts wird untersucht. Nur linienartige Geometrien werden verwendet. Je individueller Geometrie wird ein `RailwayLink` erzeugt.

Die lokale ID wird aus dem Namen der Ziel-Objektart, der AAA-ObjektID des Quell-Objekts und einer aufsteigenden Nummer der individuellen Geometrien (1., 2., Geometrie) gebildet.

Die erstellten `RailwayLink`s werden dem Index von Netzwerk-Elementen hinzugefügt.

Zusätzlich werden folgende Informationen in den entsprechenden Indizes abgelegt:

**RailwayType**

Der *railwayType* wird als `suspendedRail` festgelegt.

**VerticalPosition**

Die *verticalPosition* wird über das Attribut `hatDirektUnten` ermittelt.
Referenzen auf `AX_BauwerkImVerkehrsbereich` und `AX_BauwerkImGewaesserbereich` werden über einen Index nachgeschlagen um die entsprechende `bauwerksfunktion` zu erhalten.
Aus der `bauwerksfunktion` wird der Wert wie folgt ermittelt:

bauwerksfunktion | verticalPosition
- | -
`1800` *(Brücke)* | `suspendedOrElevated`
`1801` *(Mehrstöckige Brücke)* | `suspendedOrElevated`
`1802` *(Bogenbrücke)* | `suspendedOrElevated`
`1803` *(Fachwerkbrücke)* | `suspendedOrElevated`
`1804` *(Hängebrücke)* | `suspendedOrElevated`
`1805` *(Pontonbrücke)* | `suspendedOrElevated`
`1806` *(Drehbrücke)* | `suspendedOrElevated`
`1807` *(Hebebrücke)* | `suspendedOrElevated`
`1808` *(Zugbrücke)* | `suspendedOrElevated`
`1820` *(Steg)* | `suspendedOrElevated`
`1830` *(Hochbahn, Hochstraße)* | `suspendedOrElevated`
`1890` *(Schleusenkammer)* | `suspendedOrElevated`
`2030` *(Staumauer)* | `suspendedOrElevated`
`2040` *(Staudamm)* | `suspendedOrElevated`
`2050` *(Wehr)* | `suspendedOrElevated`
`2060` *(Sicherheitstor)* | `suspendedOrElevated`
`2080` *(Sperrwerk)* | `suspendedOrElevated`
`1870` *(Tunnel, Unterführung)* | `underground`
`2010` *(Durchlass)* | `underground`
`2011` *(Rohrdurchlass)* | `underground`
`2012` *(Düker)* | `underground`
`2070` *(Siel)* | `underground`
`2090` *(Schöpfwerk)* | `underground`

Für alle anderen `bauwerksfunktion`en, Referenzen auf andere Objekte oder auch bei Nicht-Vorhandensein von Referenzen wird der Wert `onGroundSurface` angenommen. Bei mehreren verschiedenen Referenzen haben `suspendedOrElevated` und `underground` Vorrang vor `onGroundSurface`.</documentation>
    </cell>
    <cell relation="custom:alignment:adv.geometry.simplefeature" id="C3db7a167-d20a-482b-8b61-ce70f573de62" priority="normal">
        <source name="geometrie">
            <property>
                <type name="AX_BahnstreckeType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="position" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RailwayLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="centrelineGeometry" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="Cf78462fb-2cc3-4337-b4b6-4bc3e6485717" priority="normal">
        <target>
            <property>
                <type name="RailwayLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="fictitious" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
            </property>
        </target>
        <parameter value="false" name="value"/>
    </cell>
    <cell relation="custom:alignment:adv.inspire.GeographicalName.simple" id="C79a194e1-23b0-4f14-81f7-8b0871a857c6" priority="normal">
        <source name="spelling">
            <property>
                <type name="AX_BahnstreckeType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="name" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RailwayLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
    </cell>
    <cell relation="custom:alignment:adv.inspire.GeographicalName.simple" id="C5ee0f9dd-3579-4712-a379-af803911bc0e" priority="normal">
        <source name="spelling">
            <property>
                <type name="AX_SeilbahnSchwebebahnType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="name" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RailwayLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C5ee3e63c-f81e-482a-8c6e-d390db597620" priority="normal">
        <target>
            <property>
                <type name="RailwayLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="unknown" name="value"/>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="Ce4468419-2542-4c90-a98f-02a3807111d8" priority="normal">
        <source name="id">
            <property>
                <type name="AX_BahnstreckeType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RailwayLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
    </cell>
    <cell relation="custom:alignment:adv.inspire.identifier" id="Ca7a866af-7d66-4d7a-9a25-ae2d39fca517" priority="normal">
        <source name="id">
            <property>
                <type name="AX_BahnstreckeType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RailwayLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="identifier" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </target>
    </cell>
    <cell relation="custom:alignment:adv.inspire.id.default" id="C53e1aa42-b908-4f45-8224-2a82d2a5a54f" priority="normal">
        <source name="id">
            <property>
                <type name="AX_BahnstreckeType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="id" ns="http://www.opengis.net/gml/3.2"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RailwayLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="localId" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
    </cell>
    <cell relation="custom:alignment:adv.inspire.namespace" id="C4bcaaeda-f8c5-41c5-8efa-bc3a2eaffa51" priority="normal">
        <target>
            <property>
                <type name="RailwayLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="inspireId" ns="http://inspire.ec.europa.eu/schemas/net/4.0"/>
                <child name="Identifier" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
                <child name="namespace" ns="http://inspire.ec.europa.eu/schemas/base/3.3"/>
            </property>
        </target>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C8bdc6a70-fb35-49fc-8113-0fb3aac3b041" priority="normal">
        <target>
            <property>
                <type name="RailwayLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C95a15bfe-e439-4f42-ac3f-eb3740da976a" priority="normal">
        <target>
            <property>
                <type name="RailwayLinkType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="validTo" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.retype" id="C05ddffbf-58b8-489b-b53b-44086656f42f" priority="normal">
        <source>
            <class>
                <type name="AX_BahnverkehrsanlageType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
            </class>
        </source>
        <target>
            <class>
                <type name="RailwayStationAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

// Objekte mit flächenartigen Geometrien behandeln
def areaGeometries = _.geom.findPolygons(_source.p.position.first()) ?: []

// Objekte mit punkartigen Geometrien behandeln
// Um Probleme mit der Validierung zu verhindern (Knoten werden am Ende von Kanten erwartet),
// werden in diesem Fall in Absprache mit der AdV aus den Punktgeometrien Pseudokreisflächen
// mit einem Flächeninhalt von &gt;=0,5 ha erzeugt.
def pointGeometries = _.geom.findPoints(_source.p.position.first()) ?: []
pointGeometries.each { geo -&gt;
	// Radius von 40.1 m führt zu gefordertem Flächeninhalt von &gt;=0,5 ha. Der sich mathematisch ergebende Radius
	// von ~39.9 m reicht aufgrund geometrischer Ungenauigkeiten nicht aus.
	areaGeometries &lt;&lt; _.geom.buffer(geometry: geo, distance: 40.1)
}

// Ziel unterstützt keine MultiSurfaces
def surfaces = _.geom.splitMulti(areaGeometries)

// Builder konfigurieren
// Zuweisung der Geometrie auf Ebene von geometry zulassen
_b.strictValueFlags = false

// Identifier des Quell-Objekts
def sourceId = _source.p.id.value()

// bestimme ConditionOfFacility
def conditionOfFacility = 'functional'
switch (_source.p.zustand.value()) {
case '2100': // Außer Betrieb, stillgelegt, verlassen
	conditionOfFacility = 'disused'
	break
case '4000': // Im Bau
	conditionOfFacility = 'underConstruction'
	break
}

/*
 * Sammeln von Informationen bzgl. hatDirektUnten für VerticalPosition
 */
def untenRefs = _source.p.hatDirektUnten.href.values()
def verticalPositions = untenRefs.findResults { identifier -&gt;
	def bwf = collect.bauwerksfunktion[identifier].value()
	if (bwf) {
		switch (bwf) {
		// AX_BauwerkImVerkehrsbereich
		case '1800': // Brücke
		case '1801': // Mehrstöckige Brücke
		case '1802': // Bogenbrücke
		case '1803': // Fachwerkbrücke
		case '1804': // Hängebrücke
		case '1805': // Pontonbrücke
		case '1806': // Drehbrücke
		case '1807': // Hebebrücke
		case '1808': // Zugbrücke
		case '1820': // Steg
		case '1830': // Hochbahn, Hochstraße
		case '1890': // Schleusenkammer
		// AX_BauwerkImGewaesserbereich
		case '2030': // Staumauer
		case '2040': // Staudamm
		case '2050': // Wehr
		case '2060': // Sicherheitstor
		case '2080': // Sperrwerk
			return 'suspendedOrElevated'
		// AX_BauwerkImVerkehrsbereich
		case '1870': // Tunnel, Unterführung
		// AX_BauwerkImGewaesserbereich
		case '2010': // Durchlass
		case '2011': // Rohrdurchlass
		case '2012': // Düker
		case '2070': // Siel
		case '2090': // Schöpfwerk
			return 'underground'
		}
	}
	else {
		null
	}
} as Set
def verticalPosition
if (!verticalPositions) {
	verticalPosition = 'onGroundSurface'
}
else {
	verticalPosition = verticalPositions.iterator().next()
	if (verticalPositions.size() &gt; 1) {
		_log.error('Multiple different values for vertical position of an object: ' + verticalPositions)
	}
}

// Ziel-Objekt für jede Fläche erstellen
int num = 1
surfaces.each { surface -&gt;
	// ID bestimmen
	def _id = "RailwayStationArea_${sourceId}_${num}"
	def _ns = _project.vars.INSPIRE_NAMESPACE

	// Ziel-Objekt erstellen (IDs und Geometrie)
	_target {
		id( _id )
		inspireId {
			Identifier {
				localId( _id )
				namespace( _ns )
			}
		}
		identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id : _id ) {
			codeSpace( 'http://inspire.ec.europa.eu/ids' )
		}
		geometry(surface)
	}
	
	// Sammle ID für Netzwerk
	collect.network &lt;&lt; _id
	// Sammle ID für RailwayStationCode
	if (_source.p.bezeichnung.value()) {
		collect.railwayStationCode[_source.p.bezeichnung.value()] &lt;&lt; _id
	}
	// Sammle ID für ConditionOfFacility
	collect.conditionOfFacility[conditionOfFacility] &lt;&lt; _id
	// Sammle ID für VerticalPosition
	collect.verticalPosition[verticalPosition] &lt;&lt; _id

	num++
}
</core:text>
        </complexParameter>
        <documentation>Erstellt `RailwayStationAreas`s aus `AX_Bahnverkehrsanlage`.

Die Geometrie des Quell-Objekts wird untersucht. Nur flächenartige Geometrien verwendet. Je Fläche wird eine `RailwayStationArea` erzeugt.

Die lokale ID wird aus dem Namen der Ziel-Objektart, der AAA-ObjektID des Quell-Objekts und einer aufsteigenden Nummer der Fläche (1., 2., etc. Fläche der Geometrie) gebildet.

Die erstellte `RailwayStationArea` wird dem Index von Netzwerk-Elementen hinzugefügt.

Falls die `AX_Bahnverkehrsanlage` über eine `bezeichnung` verfügt, wird dem Index für `RailwayStationCode`s die `RailwayStationArea` ebenfalls hinzugefügt.

Zusätzlich werden folgende Informationen in den entsprechenden Indizes abgelegt:

**ConditionOfFacility**

Die *conditionOfFacility* wird wie folgt aus dem Attribut `zustand` ermittelt:

zustand | conditionOfFacility
- | -
`2100` *(Außer Betrieb, stillgelegt, verlassen)* | `disused`
`4000` *(Im Bau)* | `underConstruction`

In allen anderen Fällen wird *conditionOfFacility* als `functional` angenommen.

**VerticalPosition**

Die *verticalPosition* wird über das Attribut `hatDirektUnten` ermittelt.
Referenzen auf `AX_BauwerkImVerkehrsbereich` und `AX_BauwerkImGewaesserbereich` werden über einen Index nachgeschlagen um die entsprechende `bauwerksfunktion` zu erhalten.
Aus der `bauwerksfunktion` wird der Wert wie folgt ermittelt:

bauwerksfunktion | verticalPosition
- | -
`1800` *(Brücke)* | `suspendedOrElevated`
`1801` *(Mehrstöckige Brücke)* | `suspendedOrElevated`
`1802` *(Bogenbrücke)* | `suspendedOrElevated`
`1803` *(Fachwerkbrücke)* | `suspendedOrElevated`
`1804` *(Hängebrücke)* | `suspendedOrElevated`
`1805` *(Pontonbrücke)* | `suspendedOrElevated`
`1806` *(Drehbrücke)* | `suspendedOrElevated`
`1807` *(Hebebrücke)* | `suspendedOrElevated`
`1808` *(Zugbrücke)* | `suspendedOrElevated`
`1820` *(Steg)* | `suspendedOrElevated`
`1830` *(Hochbahn, Hochstraße)* | `suspendedOrElevated`
`1890` *(Schleusenkammer)* | `suspendedOrElevated`
`2030` *(Staumauer)* | `suspendedOrElevated`
`2040` *(Staudamm)* | `suspendedOrElevated`
`2050` *(Wehr)* | `suspendedOrElevated`
`2060` *(Sicherheitstor)* | `suspendedOrElevated`
`2080` *(Sperrwerk)* | `suspendedOrElevated`
`1870` *(Tunnel, Unterführung)* | `underground`
`2010` *(Durchlass)* | `underground`
`2011` *(Rohrdurchlass)* | `underground`
`2012` *(Düker)* | `underground`
`2070` *(Siel)* | `underground`
`2090` *(Schöpfwerk)* | `underground`

Für alle anderen `bauwerksfunktion`en, Referenzen auf andere Objekte oder auch bei Nicht-Vorhandensein von Referenzen wird der Wert `onGroundSurface` angenommen. Bei mehreren verschiedenen Referenzen haben `suspendedOrElevated` und `underground` Vorrang vor `onGroundSurface`.</documentation>
    </cell>
    <cell relation="custom:alignment:adv.inspire.GeographicalName.simple" id="Ccf4d6e03-e860-410d-a4dc-2a47bc1b747a" priority="normal">
        <source name="spelling">
            <property>
                <type name="AX_BahnverkehrsanlageType" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
                <child name="name" ns="http://www.adv-online.de/namespaces/adv/gid/7.1"/>
            </property>
        </source>
        <target>
            <property>
                <type name="RailwayStationAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="GeographicalName" ns="http://inspire.ec.europa.eu/schemas/gn/4.0"/>
            </property>
        </target>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C2fd3d7ec-9da9-47f0-af0d-8502ced21036" priority="normal">
        <target>
            <property>
                <type name="RailwayStationAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="geographicalName" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="unknown" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="Cad0cc7de-46e9-4eca-9c22-a50a195d20df" priority="normal">
        <target>
            <property>
                <type name="RailwayStationAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="validFrom" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="Cfe820c80-b3ae-4187-9e5d-3ebf7baccc3f" priority="normal">
        <target>
            <property>
                <type name="RailwayStationAreaType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
                <child name="validTo" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="nilReason"/>
            </property>
        </target>
        <parameter value="other:unpopulated" name="value"/>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.create" id="C1f082d85-af49-4d27-bb48-4861e974d752" priority="low">
        <target>
            <class>
                <type name="RailwayStationCodeType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
def collect
withTransformationContext {
	collect = _.context.collector(it)
}

// Erstelle ein RailwayStationCode-Objekt für jeden vorkommenden Wert
collect.railwayStationCode.consume { key, values -&gt;
	def _id = 'RailwayStationCode_' + key
	def _ns = _project.vars.INSPIRE_NAMESPACE
	
	_target {
		stationCode( key )
		id( _id )
		inspireId {
			Identifier {
				namespace( _ns )
				localId( _id )
			}
		}
		identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id : _id ) {
			codeSpace( 'http://inspire.ec.europa.eu/ids' )
		}
		
		// Referenz zu gesammelten Objekten mit dieser Eigenschaft
		values.each { linkId -&gt;
			networkRef {
				NetworkReference {
					element {
						href( "#$linkId" )
					}
				}
			}
		}
	}
}
</core:text>
        </complexParameter>
        <documentation>Erstellt ein `RailwayStationCode`-Objekt für jeden in den Daten vorkommenden Wert für `stationCode`.

Die INSPIRE localId und die GML id werden dabei basierend auf dem Namen der Objektart und dem repräsentierten Wert gebildet. **Es ist zu prüfen ob das so immer zu gültigen GML IDs führt.**

Es werden Referenzen (NetworkReference) zu allen Netzwerk-Elementen (z.B. `RailwayStationArea` und `RailwayStationNode`) erstellt, welche die entsprechende Eigenschaft aufweisen. Diese Information wurde zuvor beim Erstellen dieser Features in einem Index abgelegt.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.create" id="C2a6fa58e-9358-425c-aec0-cbb52951e52a" priority="low">
        <target>
            <class>
                <type name="RailwayTypeType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
// Die Code-Liste für RailwayType
def codeList = 'http://inspire.ec.europa.eu/codelist/RailwayTypeValue'

def collect
withTransformationContext {
	collect = _.context.collector(it)
}

// Erstelle ein RailwayType-Objekt für jeden vorkommenden Wert
//
// Inhalt der hier gesetzt wird sind die Identifier und die Verknüpfungen
// zu den entsprechenden Netzwerk-Elementen
collect.railwayType.consume { key, values -&gt;
	def _id = 'RailwayType_' + key
	def _ns = _project.vars.INSPIRE_NAMESPACE
	
	_target {
		type {
			href( "$codeList/$key" )
		}
		id( _id )
		inspireId {
			Identifier {
				namespace( _ns )
				localId( _id )
			}
		}
		identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id : _id ) {
			codeSpace( 'http://inspire.ec.europa.eu/ids' )
		}
		
		// Referenz zu gesammelten Netzwerk-Elementen mit dieser Eigenschaft
		values.each { linkId -&gt;
			networkRef {
				NetworkReference {
					element {
						href( "#$linkId" )
					}
				}
			}
		}
	}
}
</core:text>
        </complexParameter>
        <documentation>Erstellt ein `RailwayType`-Objekt für jeden in den Daten vorkommenden Wert der [Railway Type Code-Liste](http://inspire.ec.europa.eu/codelist/RailwayTypeValue).

Die INSPIRE localId und die GML id werden dabei basierend auf dem Namen der Objektart und dem repräsentierten Wert gebildet.

Es werden Referenzen (NetworkReference) zu allen Netzwerk-Elementen (z.B. `RailwayArea` und `RailwayLink`) erstellt, welche die entsprechende Eigenschaft aufweisen. Diese Information wurde zuvor beim Erstellen dieser Features in einem Index abgelegt.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.cst.functions.groovy.create" id="Ca65a86a4-b0ae-482f-bb27-b8e9c5b51713" priority="low">
        <target>
            <class>
                <type name="RailwayUseType" ns="http://inspire.ec.europa.eu/schemas/tn-ra/4.0"/>
            </class>
        </target>
        <complexParameter name="script">
            <core:text xmlns:core="http://www.esdi-humboldt.eu/hale/core" xml:space="preserve">
// Die Code-Liste für RailwayUse
def codeList = 'http://inspire.ec.europa.eu/codelist/RailwayUseValue'

def collect
withTransformationContext {
	collect = _.context.collector(it)
}

// Erstelle ein RailwayUse-Objekt für jeden vorkommenden Wert
//
// Inhalt der hier gesetzt wird sind die Identifier und die Verknüpfungen
// zu den entsprechenden Netzwerk-Elementen
collect.railwayUse.consume { key, values -&gt;
	def _id = 'RailwayUse_' + key
	def _ns = _project.vars.INSPIRE_NAMESPACE
	
	_target {
		_b.createProperty('use') {
			href( "$codeList/$key" )
		}
		id( _id )
		inspireId {
			Identifier {
				namespace( _ns )
				localId( _id )
			}
		}
		identifier( _ns ? (_ns.endsWith('/') ? _ns : _ns + '/') + _id : _id ) {
			codeSpace( 'http://inspire.ec.europa.eu/ids' )
		}
		
		// Referenz zu gesammelten Netzwerk-Elementen mit dieser Eigenschaft
		values.each { linkId -&gt;
			networkRef {
				NetworkReference {
					element {
						href( "#$linkId" )
					}
				}
			}
		}
	}
}
</core:text>
        </complexParameter>
        <documentation>Erstellt ein `RailwayUse`-Objekt für jeden in den Daten vorkommenden Wert der [Railway Use Code-Liste](http://inspire.ec.europa.eu/codelist/RailwayUseValue).

Die INSPIRE localId und die GML id werden dabei basierend auf dem Namen der Objektart und dem repräsentierten Wert gebildet.

Es werden Referenzen (NetworkReference) zu allen Netzwerk-Elementen (z.B.  `RailwayLink`) erstellt, welche die entsprechende Eigenschaft aufweisen. Diese Information wurde zuvor beim Erstellen dieser Features in einem Index abgelegt.</documentation>
    </cell>
    <cell relation="eu.esdihumboldt.hale.align.assign" id="C13ad15bd-b849-403e-bcf4-ec122b3998bd" priority="normal">
        <target>
            <property>
                <type name="TransportNetworkType" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
                <child name="typeOfTransport" ns="http://inspire.ec.europa.eu/schemas/tn/4.0"/>
            </property>
        </target>
        <parameter value="rail" name="value"/>
    </cell>
    <modifier cell="C48d3be90-5843-4323-bd79-ba1928b2429e">
        <disable-for parent="Ca500e629-76b0-4cda-b53f-c9db0c272403"/>
    </modifier>
    <modifier cell="C4bcaaeda-f8c5-41c5-8efa-bc3a2eaffa51">
        <disable-for parent="C433d8afa-844b-4e56-b6c8-82e369fd15ea"/>
    </modifier>
    <modifier cell="C92d71e60-b3b7-4864-a6a2-fc6d46d9ac4c">
        <disable-for parent="Ca500e629-76b0-4cda-b53f-c9db0c272403"/>
    </modifier>
</alignment>
